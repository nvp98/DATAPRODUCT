@using Data_Product.Models
@using System.Security.Claims;
@using Data_Product.Repositorys;
@using Microsoft.EntityFrameworkCore;
@inject Data_Product.Repositorys.DataContext _context
@model IEnumerable<Data_Product.Models.Tbl_ChiTiet_BBGangLong_GangThoi>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script src="~/Content/assets/Chonse/chosen.jquery.js"></script>
<link href="~/Content/assets/Chonse/chosen.css" rel="stylesheet" />
@if (TempData["msgSuccess"] != null)
{
    @Html.Raw(TempData["msgSuccess"])
}
@if (TempData["msgError"] != null)
{
    @Html.Raw(TempData["msgError"])
}
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";

    Pager pager = new Pager();
    int pageNo = 0;
    if (ViewBag.Pager != null)
    {
        pager = ViewBag.Pager;
        pageNo = pager.CurrentPage;
    }
}
@{
    // int ID = Convert.ToInt32(ViewBag.Data);
    // var ID_BBGN = _context.Tbl_BienBanGiaoNhan.Where(x => x.ID_BBGN == ID).FirstOrDefault();
    // var ID_TK = _context.Tbl_TrinhKyBoSung.Where(x => x.ID_BBGN == ID).FirstOrDefault();

    //Thông tin bên nhận
    // var ThongTin_BN = _context.Tbl_TaiKhoan.Where(x => x.ID_TaiKhoan == ID_BBGN.ID_NhanVien_BN).FirstOrDefault();
    //var PhongBan_BN = _context.Tbl_PhongBan.Where(x => x.ID_PhongBan == ThongTin_BN.ID_PhongBan).FirstOrDefault();
    //var PhanXuong_BN = _context.Tbl_Xuong.Where(x => x.ID_Xuong == ThongTin_BN.ID_PhanXuong).FirstOrDefault();
    // var PhongBan_BN = _context.Tbl_PhongBan.Where(x => x.ID_PhongBan == ID_BBGN.ID_PhongBan_BN).FirstOrDefault();
    // var PhanXuong_BN = _context.Tbl_Xuong.Where(x => x.ID_Xuong == ID_BBGN.ID_Xuong_BN).FirstOrDefault();
    // var ViTri_BN = _context.Tbl_ViTri.Where(x => x.ID_ViTri == ThongTin_BN.ID_ChucVu).FirstOrDefault();

    var TenTaiKhoan = User.FindFirstValue(ClaimTypes.Name);
    var TaiKhoan = _context.Tbl_TaiKhoan.Where(x => x.TenTaiKhoan == TenTaiKhoan).FirstOrDefault();
}

<div class="app-main__outer">
    <div class="app-main__inner" style="display:block;padding-bottom: 0px;">
        <div class="tab-content">
            <div class="row">
                <div class="card">
                    <div class="row" style="width:100%">
                        <div style="display: flex;border-bottom: 0.8px solid #E8E8E8;position: fixed;background-color: #F9F9F9;width: -webkit-fill-available;">
                            <div class="col-4" style="text-align: left;padding: 2%  2%  2% 0%; ">
                                <span class="text-muted small pt-2 ps-1">
                                    <b style="color:#06428b">
                                        BM.11/QT.05 (Biên bản giao nhận nguyên/nhiên/vật tư)
                                    </b>
                                </span>
                            </div><!-- End Recent Sales -->
                            

                            <script type="text/javascript">
                                
                            </script>
                        </div>
                    </div>
                    <div class="modal" id="myModal" role="dialog" data-url='@Url.Action("HuyPhieu_PheDuyet", "XuLyPhieu", new { id = 1 })'></div>
                    <script type="text/javascript">
                        $('#btn-delete').click(function () {
                            var url = $('#myModal').data('url');
                            $.get(url, function (data) {
                                $("#myModal").html(data);
                                $("#ModalTitle").html("THÔNG TIN PHÊ DUYỆT HỦY PHIẾU");
                                $("#myModal").modal('show');
                            });
                        });
                    </script>
                    <div class="row" style="width:100%;padding-top:7.5%;">
                        <div class="col-lg-12" style="text-align: left;height: 210px;display: flex;">
                            <div class="col-xxl-4 col-md-6">
                                <img src="~/img/logoHP.png" alt="">
                                <div style="text-align: center; width: 45%; font-size: 14px; padding-top:0.5%;">
                                    <b>
                                        CÔNG TY CỔ PHẦN THÉP<br />
                                        HÒA PHÁT DUNG QUẤT
                                    </b>

                                </div>
                                
                                <div style="text-align: center; width: 45%; font-size: 14px; padding-top:0.5%;">
                                    

                                </div>

                            </div>
                            <div class="col-xxl-4 col-md-6" style="text-align:center; padding-top:7%;">
                                <h4>
                                    <b>
                                        BIÊN BẢN
                                    </b>
                                    <br />
                                    <b>
                                        GIAO NHẬN NGUYÊN/ NHIÊN/ VẬT TƯ
                                    </b>
                                </h4>
                                <span class="text-muted small pt-2 ps-1">
                                    
                                    <i style="color:black;">
                                        Kíp TEST
                                    </i>

                                </span>
                            </div>
                            <div class="col-xxl-4 col-md-6" style="text-align: right;">
                                <div style="text-align:right;font-size:14px;">
                                    <b>BM.11/QT.05</b>
                                </div>
                                <div style="text-align:right;font-size:14px;">
                                    <b> <i>Ngày hiệu lực:</i> 01/09/2024</b>
                                </div>
                                <div style="text-align:right;font-size:14px;">
                                    <b> <i>Lần sửa đổi:</i> 01</b>
                                </div>
                            </div>

                        </div><!-- End Recent Sales -->
                        <div class="col-lg-12" style="display:flex;padding-bottom: 1%;padding-top:1.5%;">
                            @{
                                // var TenTaiKhoan = User.FindFirstValue(ClaimTypes.Name);
                                // var TaiKhoan = _context.Tbl_TaiKhoan.Where(x => x.TenTaiKhoan == TenTaiKhoan).FirstOrDefault();
                                var PhongBan = _context.Tbl_PhongBan.Where(x => x.ID_PhongBan == TaiKhoan.ID_PhongBan).FirstOrDefault();
                                var PhanXuong = _context.Tbl_Xuong.Where(x => x.ID_Xuong == TaiKhoan.ID_PhanXuong).FirstOrDefault();
                                var ViTri = _context.Tbl_ViTri.Where(x => x.ID_ViTri == TaiKhoan.ID_ChucVu).FirstOrDefault();
                            }
                            <div class="col-xxl-4 col-md-6" style="height: 80px; background-color: #f9f9f9; border-radius: 10px;margin-right: 0.5%;">
                                <div style="padding-left: 3%;padding-top:3%;">
                                    <span style="color:black; font-size:14px;">
                                        Đại diện bên giao:
                                    </span>
                                </div>
                                <div style="padding-left: 3%;">
                                    <span style="color:black; font-size:14px;">
                                        @TaiKhoan.TenTaiKhoan - @TaiKhoan.HoVaTen
                                    </span>
                                </div>

                            </div>

                            <div class="col-xxl-4 col-md-6" style="height: 80px; background-color: #f9f9f9;border-radius: 10px;margin-right: 0.5%;">
                                <div style="padding-left: 3%;padding-top:3%;">
                                    <span style="color:black; font-size:14px;">
                                        Chức vụ:
                                    </span>
                                </div>
                                <div style="padding-left: 3%;">
                                    <span style="color:black; font-size:14px;">
                                        @ViTri.TenViTri
                                    </span>

                                </div>

                            </div>

                            <div class="col-xxl-4 col-md-6" style="height: 80px; background-color: #f9f9f9;margin-right: 1%;border-radius: 10px;">
                                <div style="padding-left: 3%;padding-top:3%;">
                                    <span style="color:black; font-size:14px;">
                                        BP/NM:
                                    </span>
                                </div>
                                <div style="padding-left: 3%;">
                                    <span style="color:black; font-size:14px;">
                                        @PhongBan.TenPhongBan - @PhanXuong.TenXuong
                                    </span>

                                </div>

                            </div>
                        </div>

                    </div>
                    <div class="row" style="width:100%">
                        <div class="col-lg-12" style="display:flex;padding-bottom:1%;">
                            <div class="col-xxl-4 col-md-6" style="height: 80px; background-color: #f9f9f9; border-radius: 10px;margin-right: 0.5%;">
                                <div style="padding-left: 3%;padding-top:3%;">
                                    <span style="color:black; font-size:14px;">
                                        Đại diện bên nhận:
                                    </span>
                                </div>
                                <div style="padding-left: 3%;">
                                    <span style="color:black; font-size:14px;">
                                        ThongTin_BN.TenTaiKhoan - ThongTin_BN.HoVaTen
                                    </span>
                                </div>

                            </div>
                            <div class="col-xxl-4 col-md-6" style="height: 80px; background-color: #f9f9f9;border-radius: 10px;margin-right: 0.5%;">
                                <div style="padding-left: 3%;padding-top:3%;">
                                    <span style="color:black; font-size:14px;">
                                        Chức vụ:
                                    </span>
                                </div>
                                <div style="padding-left: 3%;">
                                    <span style="color:black; font-size:14px;">
                                        ViTri_BN.TenViTri
                                    </span>

                                </div>

                            </div>

                            <div class="col-xxl-4 col-md-6" style="height: 80px; background-color: #f9f9f9;margin-right: 1%;border-radius: 10px;">
                                <div style="padding-left: 3%;padding-top:3%;">
                                    <span style="color:black; font-size:14px;">
                                        BP/NM:
                                    </span>
                                </div>
                                <div style="padding-left: 3%;">
                                    <span style="color:black; font-size:14px;">
                                        PhongBan_BN.TenPhongBan - PhanXuong_BN.TenXuong
                                    </span>

                                </div>

                            </div>
                        </div>
                    </div>
                    

                    <div class="card-body" style="padding-top: 1%;">
                        <div class="table-responsive" style="height: 400px;">
                            <table class="table table-bordered table-hover" id="dataTable" cellpadding="0">
                                <thead>
                                    <tr>
                                        <th rowspan="2">STT</th>
                                        <th rowspan="2">Số mẻ</th>
                                        <th rowspan="2">Thùng số</th>
                                        <th rowspan="2">Khối lượng xe goong</th>
                                        <th rowspan="2">Khối lượng thùng</th>
                                        <th rowspan="2">KL thùng & gang lỏng (tấn)</th>
                                        <th rowspan="2">KL gang lỏng cân ray (tấn)</th>
                                        <th colspan="2">Vận chuyển đến</th>
                                        <th rowspan="2">Phân loại</th>
                                        <th rowspan="2">Giờ</th>
                                        <th rowspan="2">Ghi chú</th>
                                    </tr>
                                    <tr>
                                        <th>NM.HRC1</th>
                                        <th>NM.HRC2</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model) {
                                        <tr>
                                            <td>1</td>
                                            <td>@item.SoMe</td>
                                            <td>@item.ThungSo</td>

                                            <td>@item.KhoiLuongXeGoong</td>
                                            <td>@item.KhoiLuongThung</td>
                                            <td>@item.KLThungGangLong</td>

                                            <td>@item.KLGangLongCanRay</td>
                                            <td><input type="checkbox" name="DaXacNhanList" value="1" @(item.VanChuyenHRC1 ? "checked" : "") disabled/></td>
                                            <td><input type="checkbox" name="DaXacNhanList" value="2" @(item.VanChuyenHRC2 ? "checked" : "") disabled/></td>
                                            <td>@item.PhanLoai</td>
                                            <td>@item.Gio</td>
                                            <td>@item.GhiChu</td>
                                        </tr>
                                    }
                                    
                                </tbody>

                            </table>

                        </div>

                    </div>
                    <div class="col-lg-12" style="text-align: left;height: 150px;display: flex;">
                        <div class="col-xxl-6 col-md-6">

                            <div style="text-align: center; font-size: 14px; padding-top:0.5%;">
                                <b>
                                    Bên nhận
                                </b>
                            </div>
                            <div style="text-align: center; font-size: 14px; padding:2%;">
                                
                            </div>
                            <div style="text-align: center; font-size: 14px;">
                                <b>
                                    ThongTin_BN.HoVaTen
                                </b>
                            </div>
                        </div>
                        <div class="col-xxl-6 col-md-6">

                            <div style="text-align: center; font-size: 14px; padding-top:0.5%;">
                                <b>
                                    Bên giao
                                </b>
                            </div>
                            <div style="text-align: center; font-size: 14px; padding:2%;">
                                
                            </div>
                            <div style="text-align: center; font-size: 14px;">
                                <b>
                                    @TaiKhoan.HoVaTen
                                </b>
                            </div>
                        </div>

                    </div>

                </div>
            </div>
        </div>

    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Lấy giá trị từ localStorage
        const savedValue = localStorage.getItem("IsShowBT");

        // Kiểm tra giá trị có tồn tại
        if (savedValue ==="1") {
            // Hiển thị giá trị lên màn hình
            var element = document.getElementById("showFunc");
            
            if (element) {
                element.style.display = "none";
            }
        }
        else {
            var element = document.getElementById("showFunc");

            if (element) {
                element.style.display = "";
            }
        }
    });
</script>